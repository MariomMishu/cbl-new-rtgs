/* Formatted on 5/16/2024 10:12:53 AM (QP5 v5.362) */
DELETE FROM TBL_RTGS_MESSAGE_LOG
      WHERE TRUNC (MSGDATE) = TRUNC (SYSDATE);

DELETE FROM TBL_INOUTMSGLOG
      WHERE TRUNC (CREATEDAT) = TRUNC (SYSDATE);

DELETE FROM TBL_BANKFNDTRANSFERTXN
      WHERE TRUNC (CREATEDAT) = TRUNC (SYSDATE) AND ROUTINGTYPE = 'Incoming';

DELETE FROM TBL_INTERBANKFUNDTRANSFER
      WHERE TRUNC (CREATEDAT) = TRUNC (SYSDATE) AND ROUTINGTYPE = 'Incoming';

DELETE FROM TBL_INTERCUSTFNDTRANSFER
      WHERE TRUNC (CREATEDAT) = TRUNC (SYSDATE) AND ROUTINGTYPE = 'Incoming';

DELETE FROM TBL_CUSTFNDTRANSFERTXN
      WHERE TRUNC (CREATEDAT) = TRUNC (SYSDATE) AND ROUTINGTYPE = 'Incoming';

DELETE FROM TBL_ACC_TXN_REGISTER
      WHERE TRUNC (CREATEDAT) = TRUNC (SYSDATE);

DELETE FROM TBL_LOG
      WHERE TRUNC (CREATEDAT) = TRUNC (SYSDATE);

UPDATE RTGS_MESSAGE_LOG
   SET PROCESSSTATUS = 'QUEUED'
 WHERE     PROCESSSTATUS = 'PROCESSED'
       AND MESSAGEDIRECTIONS = 'INWARD'
       AND MESSAGETYPE IN ('pacs.008.001.04', 'pacs.009.001.04') --, 'camt.054.001.04')
       -- AND mxmessage LIKE '%CRDT%'
       AND TRUNC (MSGDATE) = TRUNC (SYSDATE);

COMMIT;

  SELECT LOGTYPE, COUNT (*)
    FROM TBL_LOG
   WHERE TRUNC (CREATEDAT) = TRUNC (SYSDATE)
GROUP BY LOGTYPE;


  SELECT MESSAGETYPE, COUNT (*)
    FROM TBL_RTGS_MESSAGE_LOG
   WHERE TRUNC (MSGDATE) = TRUNC (SYSDATE) AND MESSAGEDIRECTIONS = 'INWARD' -- and mxmessage like '%CRDT%'
GROUP BY MESSAGETYPE;